\chapter{Одновременное оценивание движения ВС и систематических ошибок. Алгоритмы параллельной фильтрации процессов, связанных через измерения}
\renewcommand{\headtext}{\thechapter.~Одновременное оценивание движения ВС и систематических ошибок}

\newcommand{\argmin}[1]{\underset{#1}{\mathrm{argmin}}} 
\newcommand{\argmax}[1]{\underset{#1}{\mathrm{argmax}}} 
\newcommand{\cov}[1]{\mathbb{C}\mathbf{ov}\!\left\{ #1 \right\}}
\newcommand{\expect}[1]{\mathbb{E}\!\left\{ #1 \right\}}
\newcommand{\probab}[1]{\mathbf{P}\!\left\{ #1 \right\}}
\newcommand{\tr}[1]{\mathrm{tr}\!\left\{ #1 \right\}}
\newenvironment{mymatrix}[1]{\left[\begin{array}{#1}}{\end{array}\right]}
\newcommand{\transp}[1]{{#1}^\mathsf{T}}

В настоящее время в системах УВД для определения параметров движения воздушных судов 
(координаты, скорости, ускорения и т.д.) используются алгоритмы линейного рекуррентного оценивания, 
близкие по используемой математической технике к фильтру Калмана. 
В качестве основного метода применяется алгоритм IMM. 
Главная особенность состоит в том, 
что задача оценки параметров движения для всех ВС, нахоящихся в зоне наблюдения, 
решается независимо для каждого ВС. 
Это полностью соответствует представлению о том, 
что движение каждого ВС никак не зависит от движения других ВС. 
Также это удобно с точки зрения архитектуры программы, 
реализующей систему мультитраекторной обработки --- 
данные, описывающие каждое ВС, можно легко выделить в отдельный объект, 
который можно создавать, удалять и использовать, например, для сравнения 
со вновь поступающими не привязанными к конкретному ВС измернеиями. 
С точки зрения математических алгоритмов, такое разделение также удобно, 
поскольку позволяет оставаться в рамках расчётов в пространстве достаточно низкой размерности 
(4--6 для фильтра Калмана, 15--30 для IMM). 

Наблюдение за движением ВС производится с помощью радиотехнических средств: 
как правило это система из нескольких радиолокаторов и система АЗН-В. 
Реальные измерительные средства, помимо случайных ошибок измерений, 
имеют систематические ошибки. 
Случайные ошибки измерения изначально предусмотрены архитектурой алгоритмов 
рекуррентного оценивания, как фильтра Калмана, так и IMM. 
Систематические ошибки в случае не сложных вариантов их пространственной зависимости 
также легко могут быть включены в алгоритмы оценивания, 
но при их включении обнаруживается одно весьма существенное обстоятельство: 
систематические ошибки одного и того же измерительного средства 
присутствуют в уравнении наблюдения для разных воздушных судов. 
Так, в простом случае связи между неизвестными оцениваемыми состояниями и измерением РЛС 
возникает следующее линейное уравнение наблюдения: 
\begin{gather}
  z_{a \, l}(t) = C^\chi(t) \chi_a(t) + C^\varsigma(t) \varsigma_l(t) + D(t) w_l(t) \,. 
  \label{Bedin:eq:z-simple}
\end{gather}
Здесь $t$ --- момент времени; $a$ --- индекс, обозначающий номер воздушного судна (aircraft); 
$l$ --- индекс радиолокатора (locator); $z_{a l}$ --- вектор измерения; 
$\chi_a$ --- вектор параметров движения ВС; 
$\varsigma_l$ --- вектор параметров, характеризущий состояние РЛС; $w_l(t)$ --- текущая реализация 
случайной ошибки РЛС; $C^\chi(t)$, $C^\varsigma(t)$, $D(t)$ --- матрицы, характеризующие влияние 
каждого параметра на измерение. 

Из вида этого уравнения ясно, что систематическая ошибка локатора $l$ может быть 
оценена только совместно с параметрами движения ВС $a$. 
Но этот радиолокатор наблюдает не только это движение, 
также верно и обратное --- ВС $a$ наблюдается не только радиолокатором $l$. 
Фазовые переменные для разных движений оказываются <<сцепленными>> между собой 
через параметры систематических ошибок. 
Таким образом, система всех движений и всех систематических ошибок нуждается в совместном оценивании. 

Как будет показано далее, даже в простом случае неуправляемых движений, 
стандартные процедуры оптимального совместного оценивания --- 
фильтр Калмана, оценка Гаусса--Маркова --- приводят к соотношениям, 
в которых переменые, относящиеся к разным движениям и систематическим ошибкам, 
существенно связаны друг с другом. 
Это приводит к следующим неприятным последствиям: 
\begin{itemize}
  \item 
  нет возможности задать в программе отдельные объекты для движений разных ВС;
  \item
  затруднено создание и удаление движений;
  \item
  в вычислениях необходимо поддерживать большую матрицу ковариации ошибок оценивания, 
  (в которую входят все кросс-ковариации для ошибок оценивания между различными ВС, 
  между каждым ВС и каждым РЛС и т.д.) это выливается в большие затраты 
  по времени вычисления и по памяти. 
\end{itemize}
От требования, чтобы параметры оценивались оптимально, можно отказаться. 
При этом появляется возможность устранить нежелательные эффекты, указанные выше. 
Но в таком случае необходимо тщательно проектировать алгоритм оценивания, 
для того чтобы получаемые оценки были близки к неизвестным истинным параметрам. 

Целью исследования, излагаемого ниже, является создание алгоритма 
лёгкого для параллельной реализации по отдельным воздушным судам 
и при этом обладающего низким уровнем погрешности оценивания. 
Исследование логически продолжает исследование, изложенное в отчёте \cite{otch201505}. 

\section{Описание задачи наблюдения за ВС}

Считаем, что каждое воздушное судно подчиняется независимому, 
но оди по структуре уравнению движения. 
Так движение ВС номер $i$ имеет описание 
\begin{gather*}
  d\chi_i(t) = f(t, \chi_i(t), u_i(t))dt + dv_{i}(t)\,, 
\end{gather*}
где $\chi_i$ --- вектор параметров движения ВС; 
$f$ --- функция, задающая скорости движения; 
$u_i(t)$ --- функция управления, специфичная для ВС $i$; 
$dv_{i}$ --- приращение случайного возмущения для непрерывного варианта динамики; 
само дифференциальное уравнение сформулировано, например, в смысле Ито. 
В силу того, что наблюдение за ВС ведётся <<в большом масштабе>>, 
вектор $\chi_i$ может содержать не очень большое число параметров, 
а функция $f$ может быть выбрана достаточно простой. 
Измерения при помощи РЛС производятся в дискретные моменты времени, 
поэтому дальше удобно иметь дело с дискретизированным вариантом системы. 
При этом разумно ограничиться динамикой, близкой к линейной 
\begin{gather}
  \chi_i(t_k) = A_i(t_k, \chi_i(t_{k - 1}), u_i(t_k)) \chi_i(t_{k - 1}) + B_i(t_k) v_i(t_k) \,. 
  \label{Bedin:eq:x-small-control-dynamics}
\end{gather}
Здесь $v_i$ --- случайное возмущение; 
$B_i$ --- матричная функция, формирующая влияние случайного возмущения на движение; 
$A_i$ --- матрица, формирующая вид движения системы, зависящая от текущего значения управления $u(t_k)$. 
Моменты времени $t_k$ принадлежат некоторому дискретному множеству $\mathcal{T}$ 
и, на самом деле, определяются по ходу развития движения, т.е. не являются заданными заранее. 

В программе мультирадарной обработки для метода IMM уравнения движения использываются именно в виде 
\eqref{Bedin:eq:x-small-control-dynamics}. 
Далее, будем рассматривать более простую линейную динамику без управления 
\begin{gather}
  \chi_i(t_k) = A_i(\mathcal{T}_k) \chi_i(t_{k - 1}) + B_i(t_k) v_i(t_k) \,. 
  \label{Bedin:eq:x-small-dynamics}
\end{gather}
Здесь $\mathcal{T}_k = \{ t_l \in \mathcal{T} \colon \; t_l \leqslant t_k \}$ --- 
множество моментов времени до текущего включительно. 

В качестве основного варианта при моделировании выбираем 
прямолинейное равномерное движение на плоскости 
\begin{gather}
  \chi_i(t_k) = 
  \begin{bmatrix}
    x_i(t_k) \\ 
    v_i(t_k)
  \end{bmatrix}
  \,, \qquad 
  x_i(t_k), v_i(t_k) \in \mathbb{R}^\mathsf{2} 
  \,, \qquad 
  A_i(\mathcal{T}_k) = 
  \begin{bmatrix}
    I_\mathsf{2 \times 2} & (t_k - t_{k - 1}) I_\mathsf{2 \times 2} \\ 
    0_\mathsf{2 \times 2} & I_\mathsf{2 \times 2}
  \end{bmatrix}
  \,, 
  \label{Bedin:eq:x-straight-line-dynamics}
\end{gather}
где $x_i$, $v_i$ обозначают векторы координат и скорости на плоскости $\mathbb{R}^\mathsf{2}$. 
Непосредственно в моделировании используется $B_i \equiv 0$, $v_i \equiv 0$. 

Формирование наблюдений $z_{i j}$ будем описывать следующим уравнением наблюдения, 
несколько более сложным, чем уравнение \eqref{Bedin:eq:z-simple}: 
\begin{gather}
  z_{i j}(t) = C^\chi(t_k) \chi_i(t_k) + 
  C^\varsigma_j(t_k, \chi_i(t_k)) \varsigma_j(t_k) + 
  D_j(t_k, \chi_i(t_k)) w_j(t_k) \,. 
  \label{Bedin:eq:z-small-dynamics}
\end{gather}
Матрицы $C^\varsigma_j$, $D_j$ для всех имеющих смысл случаев зависят от положения ВС, 
поэтому явно указывается зависимость от $\chi_i$. 
В качестве параметров $\varsigma_j$ могут выступать постоянная систематическая ошибка по дальности 
и азимуту, коэффициент линейной зависимости для систематической ошибки по дальности и т.д. 
Матрица $C^\varsigma_j$ описывает влияние этих неизвестных параметров на измерения. 

Для параметров $\varsigma_j$, характеризующих систематические ошибки РЛС, также введём динамику 
\begin{gather}
  \varsigma_j(t_k) = A^\varsigma_j(t_k) \varsigma_j(t_{k - 1}) + B^\varsigma_j(t_k) v^\varsigma_j(t_k) \,. 
  \label{Bedin:eq:s-small-dynamics}
\end{gather}
Матрица $B^\varsigma_i$ характеризует дрейф систематических ошибок со временем. 
Для моделирования будем принимать: 
\begin{gather}
  \varsigma_j = 
  \begin{bmatrix}
    \Delta^r_j \\ \Delta^\alpha_j 
  \end{bmatrix}
  \,, \qquad 
  A^\varsigma_j(t_k) \equiv I_{\mathsf{2 \times 2}} 
  \,, \qquad
  B^\varsigma_i(t_k) \equiv 0_{\mathsf{2 \times 2}}
  \,. 
  \label{Bedin:eq:s-const-dynamics}
\end{gather} 
Здесь $\Delta^r_j, \Delta^\alpha_j \in \mathbb{R}$ --- 
значения постоянных систематических ошибок по дальности и азимуту, соответственно.  
Подробно понятия систематических ошибок по дальности и азимуту введены в отчёте 
???. 

Рассмотрим общий фазовый вектор 
\begin{gather}
  \xi(t) = 
  \begin{bmatrix}
    \chi_1(t) \\ \chi_2(t) \\ \vdots \\ \chi_n(t) \\ \varsigma_1(t) \\ \varsigma_2(t) \\ \vdots \\ \varsigma_m(t) 
  \end{bmatrix}
  \,. 
  \label{Bedin:eq:x-s-vector}
\end{gather}
Здесь $n$ и $m$ --- количества наблюдаемых ВС и наблюдающих радиолокаторов. 
Уравнения \eqref{Bedin:eq:x-small-dynamics}, \eqref{Bedin:eq:s-small-dynamics} 
можно переписать как
\begin{multline}
  \xi(t_k) = A(\mathcal{T}_k) \xi(t_{k - 1}) + B(t_k) v(t_k) 
  = \\ = 
  \begin{bmatrix}
    A_1(\mathcal{T}_k) & & & & & 0 \\
     & \ddots & & & & \\
     & & A_n(\mathcal{T}_k) & & & \\ 
    & & & A^\varsigma_1(t_k) & & \\
    & & & & \ddots & \\
    0 & & & & & A^\varsigma_m(t_k) 
  \end{bmatrix}
  \begin{bmatrix}
    \chi_1(t_{k - 1}) \\ \vdots \\ \chi_n(t_{k - 1}) \\ 
    \varsigma_1(t_{k - 1}) \\ \vdots \\ \varsigma_m(t_{k - 1}) 
  \end{bmatrix}
  + \\ + 
  \begin{bmatrix}
    B_1(t_k) & & & & & 0 \\
     & \ddots & & & & \\
     & & B_n(t_k) & & & \\ 
    & & & B^\varsigma_1(t_k) & & \\
    & & & & \ddots & \\
    0 & & & & & B^\varsigma_m(t_k) 
  \end{bmatrix}
  \begin{bmatrix}
    v_1(t_k) \\ \vdots \\ v_n(t_k) \\ 
    v^\varsigma_1(t_k) \\ \vdots \\ v^\varsigma_m(t_k) 
  \end{bmatrix}
  \,,
  \label{Bedin:eq:x-s-big-dynamics}
\end{multline}
где матрицы $A$ и $B$ представляют собой блочно-диагональные матрицы, 
объединяющие все $A_i$, $A^\varsigma_i$ и $B_i$, $B^\varsigma_i$. 

Каждый момент времени $t_k \in \mathcal{T}$ свяжем с некоторым измерением 
$z_{i j}(t_k)$ положения ВС с номером $i$ при помощи радиолокатора $j$. 
Одновременное наблюдение одного ВС несколькими радиолокаторами 
(как и одновременное наблюдение одним радиолокатором нескольких самолётов) 
будем считать пренебрежимо редким событием и не будем вводить его в модель наблюдения. 
Запишем уравнение наблюдения в том виде, как оно должно применяться ко всему большому фазовому вектору. 
\begin{gather}
  z(t_k) = z_{i j}(t_k) = C(t_k, \xi(t_k)) \xi(t_k) + D(t_k, \xi(t_k)) w(t_k) 
  \,, \label{Bedin:eq:z-big-dynamics} \\ 
  C(t_k, \xi(t_k)) = 
  \bordermatrix{
    &   &        &   & i           &   &        &   &              n + j              &   &        &   \cr 
    & 0 & \cdots & 0 & C^\chi(t_k) & 0 & \cdots & 0 & C^\varsigma_j(t_k, \chi_i(t_k)) & 0 & \cdots & 0 \cr
  }
  \,, \notag \\ 
  D(t_k, \xi(t_k)) = D_j(t_k, \chi_i(t_k))
  %\bordermatrix{
    %&   &        &   &   j                   &   &        &   \cr 
    %& 0 & \cdots & 0 & D_j(t_k, \chi_i(t_k)) & 0 & \cdots & 0 \cr
  %}
  \,, \qquad 
  w(t_k) = w_j(t_k) 
  \,. \notag 
\end{gather}

Как указывалось выше, для моделирования будем применять 
предположение постоянных систематических ошибок по дальности и азимуту. 
При этом будем использовать линеаризованную модель воздействия таких ошибок на измерения. 
Соответствующие матрицы $C^\chi(t_k)$, $C^\varsigma(t_k, \chi_i(t_k))$, $D(t_k, \chi_i(t_k))$ имеют вид: 
\begin{gather}
  C^\chi(t_k) \equiv 
  \begin{bmatrix}
    I_\mathsf{2 \times 2} & 0_\mathsf{2 \times 2}
  \end{bmatrix} 
  \,, \qquad 
  C^\varsigma_j(t_k, \chi_i(t_k)) = 
  \begin{bmatrix}
    \frac{1}{\left\lVert x_i(t_k) - x_j^\mathsf{R} \right\rVert} 
    (x_i(t_k) - x_j^\mathsf{R}) & 
    \Omega^{\pi / 2}_\mathsf{2 \times 2} 
    (x_i(t_k) - x_j^\mathsf{R})
  \end{bmatrix}
  \,, \notag \\ 
  D(t_k, \chi_i(t_k)) = 
  C^\varsigma_j(t_k, \chi_i(t_k)) 
  \,, \qquad 
  \Omega^{\pi / 2}_\mathsf{2 \times 2} = 
  \begin{bmatrix}
     0 & 1 \\ 
    -1 & 0 
  \end{bmatrix}
  \,. 
  \label{Bedin:eq:z-simple-C-D}
\end{gather}
Здесь $x_j^\mathsf{R}$ --- координаты точки стояния радиолокатора $j$; 
$\Omega^{\pi / 2}_\mathsf{2 \times 2}$ --- 
матрица поворота на угол $\frac{\pi}{2}$ против часовой стрелки 
на плоскости $\mathbb{R}^\mathsf{2}$ с учётом северо-восточной системы координат. 
Случайные ошибки 
\begin{gather*}
  w^\varsigma_j(t_k) = 
  \begin{bmatrix}
    w^r_j(t_k) \\ w^\alpha_j(t_k) 
  \end{bmatrix}
\end{gather*}
разделяются на случайные ошибки, действующие по дальности и азимуту. 

Для всех случайных ошибок считаем справедливыми свойства: 
\begin{gather}
  \expect{v_i(t_k)} = \expect{v^\varsigma_i(t_k)} = \expect{w_j(t_k)} = \expect{w_j(t_k)} = 0 
  \,, \label{Bedin:eq:v-w-properties} \\ 
  \cov{v_{i_1}(t_k), v_{i_2}(t_l)} = \delta_{k l} \delta_{i_1 i_2} V 
  \,, \qquad  
  \cov{w_{j_1}(t_k), w_{j_2}(t_l)} = \delta_{k l} \delta_{j_1 j_2} W_{j_1} 
  \,, \notag \\ 
  \cov{v_{i}(t_k), w_{j}(t_l)} = 0 
  \,, \qquad 
  \forall i, i_1, i_2 \in 1, \ldots, n \,, \; 
  \forall j, j_1, j_2 \in 1, \ldots, m \,, \; 
  \forall t_k, t_l \in \mathcal{T} \,,  
  \notag
\end{gather}
где $\delta_{p q}$ --- символ Кронекера; 
$V$ --- постоянная матрица дисперсии случайных возмущений для уравнений движения;   
$W_j$ --- постоянная матрица дисперсии случайных ошибок наблюдения для радиолокатора $j$. 

Для моделирования будем применять $W_j$ вида: 
\begin{gather}
  W_j = 
  \begin{bmatrix}
    \sigma_{r j}^\mathsf{2} & 0 \\
    0 & \sigma_{\alpha j}^\mathsf{2} 
  \end{bmatrix}
  \,, 
  \label{Bedin:eq:w-cov}
\end{gather}
где $\sigma_{r j}$, $\sigma_{\alpha j}$ --- заданные среднеквадратичные отклонения 
для случайных ошибок наблюдения по дальности и азимуту, относящихся к радиолокатору $j$. 

\section{Уравнения оптимальной фильтрации}

Целью фильтрации является получение оценки $\hat{\xi}(t_k)$ фазового вектора 
$\xi$ на момент $t_k$ поступления последнего измерения. 
Предполагается, что оценка вычисляется как некоторая функция $\Xi$ 
от информации обо всех измерениях до этого момента времени: 
\begin{gather*}
  \hat{\xi}(t_k) = \Xi\bigl(\{z(t)\}_{t \in \mathcal{T}_k} \bigr) \,,
\end{gather*}
а также от априорной информации. 
Также предполагается, что задан некоторый критерий, по которому будет определяться качество оценивания. 
Популярным выбором является: 
\begin{gather}
  J = \expect{\lVert c^\mathsf{T}(\hat{\xi}(t_k) - \xi(t_k))\rVert^\mathsf{2}} \,, 
  \label{Bedin:eq:crit}
\end{gather}
где $c^\mathsf{T}$ --- некоторая заданная линейная функция, 
выделяющая, например, некоторую часть координат из всего вектора, 
$\xi(t_k)$ --- истинное значение фазового вектора $\xi$ в момент времени $t_k$. 
Поскольку речь идёт об оценивании в присутствии случайных ошибок наблюдения, 
оценка $\hat{\xi}(t_k)$ является случайной величиной, 
и в критерии присутствует символ математического ожидания $\expect{\cdot}$. 

Наиболее простыми и разумными с точки зрения оптимальности 
являются линейные рекуррентные оценки с линейным прогнозированием: 
\begin{align}
  \bar{\xi}(t_k) & = A(t_k) \hat{\xi}(t_{k - 1}) 
  \,, \label{Bedin:eq:recursive-est-pred} \\
  \hat{\xi}(t_k) & = L(t_k, R(t_k)) \bar{\xi}(t_k) + K(t_k, R(t_k)) z(t_k) 
  \,, \label{Bedin:eq:recursive-est-corr} \\ 
  R(t_k) & = \mathcal{F}(t_k, R(t_{k - 1}) 
  \,. \label{Bedin:eq:recursive-est-add-par} 
\end{align}
Здесь $L(t_k, R(t_k))$ и $K(t_k, R(t_k))$ --- матричные коэффициенты, 
выбираемые для каждого момента самостоятельно, и зависящие от параметров линейных уравнений 
\eqref{Bedin:eq:x-s-big-dynamics}, \eqref{Bedin:eq:z-big-dynamics}, 
а также от вектора дополнительных параметров $R(t_k)$, пересчитываемого отдельно по некоторму, 
уже в общем случае нелинейному, правилу \eqref{Bedin:eq:recursive-est-add-par}. 
Уравнение прогноза \eqref{Bedin:eq:recursive-est-pred} 
обеспечивает оптимальную по имеющейся информации $\hat{\xi}(t_{k - 1})$ 
оценку вектора $\xi(t_k)$ среди всех возможных оценок вообще. 
Т.е. при оптимальном выборе $\hat{\xi}(t_{k - 1})$ 
оценка $\bar{\xi}(t_k)$ является оптимальной среди всех оценок 
вектора $\xi(t_k)$ по измерениям, предшествующим моменту $t_k$. 
Уравнение \eqref{Bedin:eq:recursive-est-corr} называют уравнением коррекции. 
Его целью является получение новой оценки, учитывющий последнее измерение. 

Далее в тексте, если рассматриваемые величины 
$\hat{\xi}(t_k)$, $\bar{\xi}(t_k)$, $L(t_k, R(t_k))$, и~т.~д. 
относятся к одному и тому же моменту времени $t_k$, 
скобки с аргументами в некоторых случаях будут опускаться, 
если это не будет создавать двусмысленности. 

Популярным дополнительным условием является условие несмещённости оценки 
\begin{gather}
  \expect{\hat{\xi}(t_k)} = \expect{\xi(t_k)} \,, 
  \label{Bedin:eq:est-unbiased-random}
\end{gather}
которое в случае детерминированного фазового вектора $\xi$, 
например, в случае равенства нулю матрицы $B(t_k)$ в уравнении \eqref{Bedin:eq:x-s-big-dynamics}, 
принимает вид 
\begin{gather}
  \expect{\hat{\xi}(t_k)} = \xi(t_k) \,. 
  \label{Bedin:eq:est-unbiased-determ}
\end{gather}

Если оценка $\hat{\xi}(t_{k - 1})$ удовлетворяет условию \eqref{Bedin:eq:est-unbiased-random}, 
легко видеть, что и оценка $\bar{\xi}(t_k)$ ему удовлетворяет 
в силу уравнения \eqref{Bedin:eq:x-s-big-dynamics}. 
Для уравнения коррекции условие несмещённости \eqref{Bedin:eq:est-unbiased-random} 
приводит к следующему условию 
\begin{multline*}
  \expect{\hat{\xi}(t_k)} = 
  L \, \expect{\bar{\xi}(t_k)} + K \, \expect{z(t_k)} 
  = \\ = 
  L \, \expect{\xi(t_k)} 
  + K \, \expect{C(t_k, \xi(t_k)) \xi(t_k)} 
  + K \, \expect{D(t_k, \xi(t_k)) w(t_k)} 
  = \\ = 
  L \, \expect{\xi(t_k)} 
  + K \, \expect{C(t_k, \xi(t_k)) \xi(t_k)} 
  + K \, \expect{D(t_k, \xi(t_k))} \expect{w(t_k)} 
  = \\ = 
  L \, \expect{\xi(t_k)} 
  + K \, \expect{C(t_k, \xi(t_k)) \xi(t_k)} 
  \,, \\ \Longrightarrow 
  L \, \expect{\xi(t_k)} = I - K \, \expect{C(t_k, \xi(t_k)) \xi(t_k)} 
  \,, 
\end{multline*}
которое для случая матрицы $C$, не зависящей от $\xi$, или для случая, 
когда вектор $\xi$ является детерминированным, 
переходит в матричное условие 
\begin{gather}
  L(t_k, R(t_k)) = I - K(t_k, R(t_k)) \, C(t_k, \xi(t_k)) \,.  
  \label{Bedin:eq:est-unbiased-L}
\end{gather} 
В случае рассматриваемой нами модельной системы матрица $C$ очень слабо зависит от $\xi$. 
Так, заменив в выражении \eqref{Bedin:eq:z-simple-C-D} для матрицы $C^\varsigma_j(t_k, \xi(t_k))$ 
вектор $x_i(t_k)$ на $z_{i j}(t_k)$ или $\bar{x}_i(t_k)$ (часть прогнозной оценки $\bar{\xi}(t_k)$), 
мы получим близкое выражение, пригодное для использования в линейных алгоритмах. 
Далее, все алгоритмы будут рассматирваться с условием \eqref{Bedin:eq:est-unbiased-L}. 
При его подстановке в уравнение коррекции получается 
\begin{gather}
  \hat{\xi}(t_k) = \bar{\xi}(t_k) + K  
  \left( z(t_k) - C(t_k, \bar{\xi}(t_k)) \, \bar{\xi}(t_k) \right) \,. 
  \label{Bedin:eq:recursive-est-corr-unbiased}
\end{gather}

Слагаемое $C(t_k, \bar{\xi}(t_k)) \, \bar{\xi}(t_k)$ 
можно проинтерпретировать как прогнозное измерение на момент $t_k$. 
Таким образом в выражении оценки \eqref{Bedin:eq:recursive-est-corr-unbiased} 
фигурирует разность между действительным и прогнозым измерениями. 

Введём обозначения. 


\subsection{Полная система}
Фильтр для фазового вектора. \\

\noindent Этап предсказания:
\[\bar{x}_{t} = A_{x}\hat{x}_{t-1} \]
\[\bar{P}_{x,t} = A_{x}\hat{P}_{x,t-1}A_{x}^T + B_{x}B_{x}^T\]
Этап коррекции:
\[\hat{x}_{t} = \bar{x}_{t} + K_{x}\Lambda(z_{t} - C_{x}\bar{x}_{t} - C_{s}\bar{s}_{t})\]
\[\hat{P}_{x,t} = \bar{P}_{x,t} - K_{x}\Lambda K_{x}^T\]
\[K_{x} = \bar{P}_{x,t}C_{x}^T + \bar{P}_{xs,t}C_{s}^T \] \\
\noindent Фильтр для систематической ошибки. \\


\noindent Этап предсказания:
\[\bar{s}_{t} = A_{s}\hat{s}_{t-1} \]
\[\bar{P}_{s,t} = A_{s}\hat{P}_{s,t-1}A_{s}^T + B_{s}B_{s}^T\]
Этап коррекции:
\[\hat{s}_{t} = \bar{s}_{t} + K_{s}\Lambda(z_{t} - C_{x}\bar{x}_{t} - C_{s}\bar{s}_{t})\]
\[\hat{P}_{s,t} = \bar{P}_{s,t} - K_{s}\Lambda K_{s}^T\]
\[K_{s} = \bar{P}_{s,t}C_{s}^T + \bar{P}_{xs,t}^TC_{x}^T \] 
Обновление блока кросс-ковариации:
\[\bar{P}_{xs,t} = A_{x}\hat{P}_{xs,t-1}A_{s}^T\]
\[\hat{P}_{xs,t} = \bar{P}_{xs,t} - K_{x}\Lambda K_{s}^T\] 
В данном случае для обоих фильтров используется одна матрица $\Lambda$:
\[\Lambda = C_{x}\bar{P}_{x,t}C_{x}^T + C_{s}\bar{P}_{s,t}C_{s}^T + C_{x}\bar{P}_{xs,t}C_{s}^T + 
C_{s}\bar{P}_{xs,t}^TC_{x}^T + DD^T\] 
Уравнение наблюдения:
\[z_{t} = C_{x}x_{t} + C_{s}s_{t} + Dw\]

%\newpage

\section{Упрощеные алгоритмы оценивания по Henk Blom}

В статье \cite{Blom1993} рассматривается точно такая же задача одновременного 
оценивания движения многих ВС и определения систематических ошибок. 
Приводятся варианты упрощения алгоритма фильтрации Калмана, 
показавшие хорошую работу на практике.  

\subsection{Фильтр Калмана для фазового вектора, \\Макро фильтр для систематической ошибки}
\noindent Фильтр для фазового вектора. \\


\noindent Этап предсказания:
\[\bar{x}_{t} = A_{x}\hat{x}_{t-1} \]
\[\bar{P}_{x,t} = A_{x}\hat{P}_{x,t-1}A_{x}^T + B_{x}B_{x}^T\]
Этап коррекции:
\[\hat{x}_{t} = \bar{x}_{t} + K_{x}\Lambda_{x}(z_{t} - C_{x}\bar{x}_{t} - C_{s}\bar{s}_{t})\]
\[\hat{P}_{x,t} = \bar{P}_{x,t} - K_{x}\Lambda_{x} K_{x}^T\] 
Аппроксимация:
\[K_{x} = \bar{P}_{x,t}C_{x}^T \]
\[\Lambda_{x} = C_{x}\bar{P}_{x,t}C_{x}^T + DD^T\] \\
Фильтр для систематической ошибки. \\


\noindent Этап предсказания:
\[\bar{s}_{t} = A_{s}\hat{s}_{t-1} \]
\[\bar{P}_{s,t} = A_{s}\hat{P}_{s,t-1}A_{s}^T + B_{s}B_{s}^T\]
Этап коррекции:
\[\hat{s}_{t} = \bar{s}_{t} + K_{s}\Lambda_{s}(z_{t} - C_{x}\bar{x}_{t} - C_{s}\bar{s}_{t})\]
\[\hat{P}_{s,t} = \bar{P}_{s,t} - K_{s}\Lambda_{s} K_{s}^T\] 
В вычислении матриц $K_{s}$ и $\Lambda_{s}$ используются аппроксимация члена $C_{x}\bar{P}_{xs,t}$:
\[K_{s} = \bar{P}_{s,t}C_{s}^T + H^T \]
\[\Lambda = C_{x}\bar{P}_{x,t}C_{x}^T + C_{s}\bar{P}_{s,t}C_{s}^T + HC_{s}^T + 
C_{s}H^T + DD^T\] \\
Где $H$:
\[F_{x} = \sum_{i = 1}^{M}(D_{i}D_{i}^T)^{-1}\]
\[F_{s} = \sum_{i = 1}^{M}(D_{i}D_{i}^T)^{-1}C_{s,i}\]
\[H = -(F_{x}^TF_{x})^{-1}F_{x}^TF_{s}\bar{P}_{s,t}\] 
Где $M$ - количество радиолокаторов. \\

Уравнение наблюдения:
\[z_{t} = C_{x}x_{t} + C_{s}s_{t} + Dw\]

\newpage

\subsection{Разделённые фильтры для фазового вектора и для систематической ошибки}
\noindent Фильтр для фазового вектора. \\


\noindent Этап предсказания:
\[\bar{x}_{t} = A_{x}\hat{x}_{t-1} \]
\[\bar{P}_{x,t} = A_{x}\hat{P}_{x,t-1}A_{x}^T + B_{x}B_{x}^T\]
Этап коррекции:
\[\hat{x}_{t} = \bar{x}_{t} + K_{x}\Lambda_{x}(z_{t} - C_{x}\bar{x}_{t} - C_{s}\bar{s}_{t})\]
\[\hat{P}_{x,t} = \bar{P}_{x,t} - K_{x}\Lambda_{x} K_{x}^T\] 
Аппроксимация:
\[K_{x} = \bar{P}_{x,t}C_{x}^T \]
\[\Lambda_{x} = C_{x}\bar{P}_{x,t}C_{x}^T + DD^T\] \\
Фильтр для систематической ошибки. \\


\noindent Этап предсказания:
\[\bar{s}_{t} = A_{s}\hat{s}_{t-1} \]
\[\bar{P}_{s,t} = A_{s}\hat{P}_{s,t-1}A_{s}^T + B_{s}B_{s}^T\]
Этап коррекции:
\[\hat{s}_{t} = \bar{s}_{t} + K_{s}\Lambda_{s}(z_{t} - C_{x}\bar{x}_{t} - C_{s}\bar{s}_{t})\]
\[\hat{P}_{s,t} = \bar{P}_{s,t} - K_{s}\Lambda_{s} K_{s}^T\]
Аппроксимация:
\[K_{s} = \bar{P}_{s,t}C_{s}^T \]
\[\Lambda_{s} = C_{s}\bar{P}_{s,t}C_{s}^T + DD^T\]
Уравнение наблюдения:
\[z_{t} = C_{x}x_{t} + C_{s}s_{t} + Dw\]

