\chapter{Одновременное оценивание движения ВС и систематических ошибок. Алгоритмы параллельной фильтрации процессов, связанных через измерения}
\renewcommand{\headtext}{\thechapter.~Одновременное оценивание движения ВС и систематических ошибок}

В настоящее время в системах УВД для определения параметров движения воздушных судов 
(координаты, скорости, ускорения и т.д.) используются алгоритмы линейного рекуррентного оценивания, 
близкие по используемой математической технике к фильтру Калмана. 
В качестве основного метода применяется алгоритм IMM. 
Как основную особенность можно отметить, 
что задача оценки параметров движения для всех ВС, нахоящихся в зоне наблюдения, 
решается независимо для каждого ВС. 
Это полностью соответствует представлению о том, 
что движение каждого ВС никак не зависит от движения других ВС. 
Также это удобно с точки зрения архитектуры программы, 
реализующей систему мультитраекторной обработки --- 
данные, описывающие каждое ВС, можно легко выделить в отдельный объект, 
который можно создавать, удалять и использовать, например, для сравнения 
со вновь поступающими не привязанными к конкретному ВС измернеиями. 
С точки зрения математических алгоритмов, такое разделение также удобно, 
поскольку позволяет оставаться в рамках расчётов в пространстве достаточно низкой размерности 
(4--6 для фильтра Калмана, 15--30 для IMM). 

Наблюдение за движением ВС производится с помощью радиотехнических средств: 
как правило это система из нескольких радиолокаторов и система АЗН-В. 
Реальные измерительные средства, помимо случайных ошибок измерений, 
имеют систематические ошибки. 
Случайные ошибки измерения изначально предусмотрены архитектурой алгоритмов 
рекуррентного оценивания, как фильтра Калмана, так и IMM. 
Систематические ошибки в случае не сложных вариантов их пространственной зависимости 
также легко могут быть включены в алгоритмы оценивания, 
но при их включении обнаруживается одно весьма существенное обстоятельство: 
систематические ошибки одного и того же измерительного средства 
присутствуют в уравнении наблюдения для разных воздушных судов. 
Так, в простом случае линейной модели наблюдения РЛС возникает следующее уравнение 
наблюдения (связи между неизвестными оцениваемыми состояниями и измерением): 
\begin{gather}
  z_{a \, l}(t) = C_x(t) x_a(t) + C_s(t) s_l(t) + D(t) w_l(t) \,. 
  \label{Bedin:eq:obs-x-s-simple}
\end{gather}
Здесь $t$ --- момент времени; $a$ --- индекс, обозначающий номер воздушного судна (aircraft); 
$l$ --- индекс радиолокатора (locator); $z_{a \, l}$ --- вектор измерения; 
$x_a$ --- вектор параметров движения ВС; 
$s_l$ --- вектор параметров, характеризущий состояние РЛС; $w_l(t)$ --- текущая реализация 
случайной ошибки РЛС; $C_x(t)$, $C_s(t)$, $D(t)$ --- матрицы, характеризующие вклад 
каждого параметра на измерение. 

Из вида этого уравнения ясно, что систематическая ошибка локатора $l$ может быть 
оценена только совместно с параметрами движения ВС $a$. 
Но этот радиолокатор наблюдает не только это движение, 
также верно и обратное --- ВС $a$ наблюдается не только радиолокатором $l$. 
Фазовые переменные для разных движений оказываются <<сцепленными>> между собой 
через параметры систематических ошибок. 
Таким образом, система всех движений и всех систематических ошибок нуждается в совместном оценивании. 

Рассмотрим общий фазовый вектор 
\begin{gather}
  \chi(t) = 
  \begin{bmatrix}
    x_1(t) \\ x_2(t) \\ \vdots \\ x_n(t) \\ s_1(t) \\ s_2(t) \\ \vdots \\ s_m(t) 
  \end{bmatrix}
  \,. 
  \label{Bedin:eq:x-s-vector}
\end{gather}
Здесь $n$ и $m$ --- количества наблюдаемых ВС и наблюдающих радиолокаторов. 

\section{Алгоритмы оценивания Henk Blom}

\subsection{Полная система}
Фильтр для фазового вектора. \\


\noindent Этап предсказания:
\[\bar{x}_{t} = A_{x}\hat{x}_{t-1} \]
\[\bar{P}_{x,t} = A_{x}\hat{P}_{x,t-1}A_{x}^T + B_{x}B_{x}^T\]
Этап коррекции:
\[\hat{x}_{t} = \bar{x}_{t} + K_{x}\Lambda(z_{t} - C_{x}\bar{x}_{t} - C_{s}\bar{s}_{t})\]
\[\hat{P}_{x,t} = \bar{P}_{x,t} - K_{x}\Lambda K_{x}^T\]
\[K_{x} = \bar{P}_{x,t}C_{x}^T + \bar{P}_{xs,t}C_{s}^T \] \\
\noindent Фильтр для систематической ошибки. \\


\noindent Этап предсказания:
\[\bar{s}_{t} = A_{s}\hat{s}_{t-1} \]
\[\bar{P}_{s,t} = A_{s}\hat{P}_{s,t-1}A_{s}^T + B_{s}B_{s}^T\]
Этап коррекции:
\[\hat{s}_{t} = \bar{s}_{t} + K_{s}\Lambda(z_{t} - C_{x}\bar{x}_{t} - C_{s}\bar{s}_{t})\]
\[\hat{P}_{s,t} = \bar{P}_{s,t} - K_{s}\Lambda K_{s}^T\]
\[K_{s} = \bar{P}_{s,t}C_{s}^T + \bar{P}_{xs,t}^TC_{x}^T \] 
Обновление блока кросс-ковариации:
\[\bar{P}_{xs,t} = A_{x}\hat{P}_{xs,t-1}A_{s}^T\]
\[\hat{P}_{xs,t} = \bar{P}_{xs,t} - K_{x}\Lambda K_{s}^T\] 
В данном случае для обоих фильтров используется одна матрица $\Lambda$:
\[\Lambda = C_{x}\bar{P}_{x,t}C_{x}^T + C_{s}\bar{P}_{s,t}C_{s}^T + C_{x}\bar{P}_{xs,t}C_{s}^T + 
C_{s}\bar{P}_{xs,t}^TC_{x}^T + DD^T\] 
Уравнение наблюдения:
\[z_{t} = C_{x}x_{t} + C_{s}s_{t} + Dw\]

%\newpage

\subsection{Фильтр Калмана для фазового вектора, \\Макро фильтр для систематической ошибки}
\noindent Фильтр для фазового вектора. \\


\noindent Этап предсказания:
\[\bar{x}_{t} = A_{x}\hat{x}_{t-1} \]
\[\bar{P}_{x,t} = A_{x}\hat{P}_{x,t-1}A_{x}^T + B_{x}B_{x}^T\]
Этап коррекции:
\[\hat{x}_{t} = \bar{x}_{t} + K_{x}\Lambda_{x}(z_{t} - C_{x}\bar{x}_{t} - C_{s}\bar{s}_{t})\]
\[\hat{P}_{x,t} = \bar{P}_{x,t} - K_{x}\Lambda_{x} K_{x}^T\] 
Аппроксимация:
\[K_{x} = \bar{P}_{x,t}C_{x}^T \]
\[\Lambda_{x} = C_{x}\bar{P}_{x,t}C_{x}^T + DD^T\] \\
Фильтр для систематической ошибки. \\


\noindent Этап предсказания:
\[\bar{s}_{t} = A_{s}\hat{s}_{t-1} \]
\[\bar{P}_{s,t} = A_{s}\hat{P}_{s,t-1}A_{s}^T + B_{s}B_{s}^T\]
Этап коррекции:
\[\hat{s}_{t} = \bar{s}_{t} + K_{s}\Lambda_{s}(z_{t} - C_{x}\bar{x}_{t} - C_{s}\bar{s}_{t})\]
\[\hat{P}_{s,t} = \bar{P}_{s,t} - K_{s}\Lambda_{s} K_{s}^T\] 
В вычислении матриц $K_{s}$ и $\Lambda_{s}$ используются аппроксимация члена $C_{x}\bar{P}_{xs,t}$:
\[K_{s} = \bar{P}_{s,t}C_{s}^T + H^T \]
\[\Lambda = C_{x}\bar{P}_{x,t}C_{x}^T + C_{s}\bar{P}_{s,t}C_{s}^T + HC_{s}^T + 
C_{s}H^T + DD^T\] \\
Где $H$:
\[F_{x} = \sum_{i = 1}^{M}(D_{i}D_{i}^T)^{-1}\]
\[F_{s} = \sum_{i = 1}^{M}(D_{i}D_{i}^T)^{-1}C_{s,i}\]
\[H = -(F_{x}^TF_{x})^{-1}F_{x}^TF_{s}\bar{P}_{s,t}\] 
Где $M$ - количество радиолокаторов. \\

Уравнение наблюдения:
\[z_{t} = C_{x}x_{t} + C_{s}s_{t} + Dw\]

\newpage

\subsection{Разделённые фильтры для фазового вектора и для систематической ошибки}
\noindent Фильтр для фазового вектора. \\


\noindent Этап предсказания:
\[\bar{x}_{t} = A_{x}\hat{x}_{t-1} \]
\[\bar{P}_{x,t} = A_{x}\hat{P}_{x,t-1}A_{x}^T + B_{x}B_{x}^T\]
Этап коррекции:
\[\hat{x}_{t} = \bar{x}_{t} + K_{x}\Lambda_{x}(z_{t} - C_{x}\bar{x}_{t} - C_{s}\bar{s}_{t})\]
\[\hat{P}_{x,t} = \bar{P}_{x,t} - K_{x}\Lambda_{x} K_{x}^T\] 
Аппроксимация:
\[K_{x} = \bar{P}_{x,t}C_{x}^T \]
\[\Lambda_{x} = C_{x}\bar{P}_{x,t}C_{x}^T + DD^T\] \\
Фильтр для систематической ошибки. \\


\noindent Этап предсказания:
\[\bar{s}_{t} = A_{s}\hat{s}_{t-1} \]
\[\bar{P}_{s,t} = A_{s}\hat{P}_{s,t-1}A_{s}^T + B_{s}B_{s}^T\]
Этап коррекции:
\[\hat{s}_{t} = \bar{s}_{t} + K_{s}\Lambda_{s}(z_{t} - C_{x}\bar{x}_{t} - C_{s}\bar{s}_{t})\]
\[\hat{P}_{s,t} = \bar{P}_{s,t} - K_{s}\Lambda_{s} K_{s}^T\]
Аппроксимация:
\[K_{s} = \bar{P}_{s,t}C_{s}^T \]
\[\Lambda_{s} = C_{s}\bar{P}_{s,t}C_{s}^T + DD^T\]
Уравнение наблюдения:
\[z_{t} = C_{x}x_{t} + C_{s}s_{t} + Dw\]

